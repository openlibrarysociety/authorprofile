#!/usr/bin/perl

package ACISshortid;

use strict;
use warnings;

# To be implemented
# Will be a base class containing filePath, AMFXMLRootElement attributes
# our @AMF::ISA=('AMFobject');

sub new {
  my $class=shift;
  
  my $self = {'shortidStr' => shift,
              'filePath' => shift,
              'AMFXMLRootElement' => shift,
              'AMFXMLshortidElement' => shift
             };

  if(not $self->{'shortidStr'}) {

    if($self->{'AMFXMLshortidElement'}) {

      my $shortidStr;
      eval { $shortidStr=$self->{'AMFXMLshortidElement'}->textContent; };
      if($@) {
        # Fix: This should be a file name
        warn 'Warning: Could not retrieve the ACIS shortid string for the file ',$self->{'AMFXMLshortidElement'}->documentElement->textContent,$@;
        bless $self,$class;
        return $self;
      }

      $self->{'shortidStr'}=$shortidStr;

      # Address this: Need eval {}'s
      $self->{'AMFXMLRootElement'}=$self->{'AMFXMLshortidElement'}->ownerDocument->documentElement;
      $self->{'filePath'}=$self->{'AMFXMLshortidElement'}->ownerDocument->URI;
    }

  }

  bless $self,$class;
  return $self;
}

1;
